---
import CodeEmbed from "../CodeEmbed";

interface Props {
  code: string;
  previewWidth?: number;
  previewHeight?: number;
}

const { props } = Astro;

let previewWidth = props.previewWidth;
let previewHeight = props.previewHeight;
const match = /createCanvas\(\s*(\d+),\s*(\d+)\s*(?:P2D|WEBGL\s*)?\)/m.exec(props.code);
if (match) {
  previewWidth = previewWidth || parseFloat(match[1]);
  previewHeight = previewHeight || parseFloat(match[2]);
}

---

<CodeEmbed client:load initialValue={props.code.trim()} previewWidth={previewWidth} previewHeight={previewHeight} previewable editable />
