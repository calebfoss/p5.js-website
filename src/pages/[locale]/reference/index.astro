---
import BaseLayout from "@layouts/BaseLayout.astro";
import { nonDefaultSupportedLocales } from "@i18n/const";
import {
  getCollectionInLocaleWithFallbacks,
  makeReferencePageSlug,
} from "@pages/_utils";
import { removeLocalePrefix } from "@i18n/utils";

export async function getStaticPaths() {
  const paths = nonDefaultSupportedLocales.map(async (locale) => ({
    params: {
      locale,
    },
    props: {
      entries: await getCollectionInLocaleWithFallbacks("reference", locale),
    },
  }));

  return await Promise.all(paths);
}

const { locale } = Astro.params;
const { entries } = Astro.props;
---

<BaseLayout title="Reference">
  <ul>
    {
      entries.map((refEntry) => (
        <li>
          <a
            href={`/${locale}/reference${makeReferencePageSlug(removeLocalePrefix(refEntry.id))}`}
          >
            {refEntry.data.title}
          </a>
        </li>
      ))
    }
  </ul>
</BaseLayout>
