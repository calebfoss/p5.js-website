---
import {
  setJumpToState,
  type JumpToLink,
  type JumpToState,
} from "../globals/state";
import { useTranslations, getCurrentLocale } from "../i18n/utils";
import BaseLayout from "./BaseLayout.astro";
import { type MarkdownHeading } from "astro";

const currentLocale = getCurrentLocale(Astro.url.pathname);
const t = await useTranslations(currentLocale);

const { entry } = Astro.props;
const { Content, headings } = await entry.render();

const jumpToLinks = headings
  .filter((heading: MarkdownHeading) => heading.depth <= 3)
  .map((heading: MarkdownHeading) => ({
    label: heading.text,
    url: `#${heading.slug}`,
  }));

const jumpToState = {
  links: jumpToLinks as JumpToLink[],
  heading: t("Contributor Docs"),
} as JumpToState;

setJumpToState(jumpToState);
---

<BaseLayout title="Placeholder title">
  <Content />
</BaseLayout>
